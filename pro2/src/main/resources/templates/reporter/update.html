<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>기자 정보 수정</title>
	<link rel="stylesheet" th:href="@{/css/reporter.css}" />
</head>
<body>
    <h2>기자 정보 수정</h2>

    <form th:action="@{/reporter/update}" method="post">
        <!-- 사용자 정보 -->
        <label>아이디 : </label>
        <input type="text" th:value="${user.id}" name="id" readonly><br>

        <label>이름 : </label>
        <input type="text" th:value="${user.name}" name="name"><br>

        <label>닉네임 : </label>
        <input type="text" th:value="${user.nick}" name="nick"><br>

        <label>전화번호 : </label>
        <input type="text" th:value="${user.phone}" name="phone"><br>

        <label>이메일 : </label>
        <input type="text" th:value="${user.email}" name="email"><br>

        <!-- 기자 정보 -->
        <div th:if="${reporter != null}">
            <h3>기자 상세 정보</h3>

            <!-- ID는 UsersDTO와 ReporterDTO 양쪽에 존재 -->
            <input type="hidden" th:value="${reporter.id}" name="reporter.id" />


            <label>상위 카테고리 : </label>
			<select name="mainCategory" required>
				  <option value="">선택</option>
				  <option value="news">뉴스</option>
				  <option value="sports">스포츠</option>
				  <option value="enter">엔터</option>
			</select><br>
			
			<label>하위 카테고리 : </label>
			<select name="subCategory" id="subCategory" required>
				<option value="">선택</option>
			</select> <br>
            <label>소개 : </label>
            <textarea name="intro" rows="4" cols="30" th:text="${reporter.intro}"></textarea><br>
        </div>

        <button type="submit">수정하기</button>
    </form>

	<div id="result-message"></div>

	    <script>
	        $(document).ready(function () {
	            $('#updateForm').on('submit', function (e) {
	                e.preventDefault(); // 폼 기본 제출 방지

	                $.ajax({
	                    url: '/reporter/update',
	                    type: 'POST',
	                    data: $(this).serialize(),
	                    success: function (response) {
	                        $('#content-area').html(response); // 수정된 정보 보여주기
	                    },
	                    error: function () {
	                        $('#result-message').html('<p style="color:red;">수정 실패</p>');
	                    }
	                });
	            });
	        });
	    </script>
		<script>
		    document.addEventListener('DOMContentLoaded', function () {
		        const mainCategory = document.getElementById('mainCategory');
		        const subCategory = document.getElementById('subCategory');

		        const categoryMap = {
		            news: ['정치', '경제', '사회'],
		            sports: ['야구', '축구', '배구', '농구'],
		            entertainment: ['드라마', '영화', '뮤직']
		        };

		        mainCategory.addEventListener('change', function () {
		            const selected = this.value;
		            const options = categoryMap[selected] || [];

		            // 기존 옵션 초기화
		            subCategory.innerHTML = '<option value="">선택</option>';

		            // 새로운 옵션 추가
		            options.forEach(function (opt) {
		                const optionElem = document.createElement('option');
		                optionElem.value = opt;
		                optionElem.textContent = opt;
		                subCategory.appendChild(optionElem);
		            });
		        });
		    });
		</script>		
	</body>
	</html>

